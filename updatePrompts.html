<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Prompts</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
    <div class="bg-white rounded-xl shadow-lg p-8 max-w-lg w-full">
        <h1 class="text-2xl font-bold mb-6">Add New Prompt</h1>
        <form id="updatePromptForm" class="space-y-4">
            <div>
                <label for="promptTitle" class="block text-sm font-medium text-gray-700 mb-1">Prompt Title</label>
                <input type="text" id="promptTitle" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" placeholder="Enter the prompt title">
            </div>
            <div>
                <label for="promptText" class="block text-sm font-medium text-gray-700 mb-1">Prompt Text</label>
                <textarea id="promptText" rows="5" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500" placeholder="Enter the full prompt text"></textarea>
            </div>
            <div>
                <label for="promptCategory" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                <select id="promptCategory" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    <option value="">Select a category</option>
                </select>
            </div>
            <div>
                <label for="promptOutputType" class="block text-sm font-medium text-gray-700 mb-1">Output Type</label>
                <select id="promptOutputType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    <option value="">Select an output type</option>
                </select>
            </div>
            <div>
                <label for="promptLanguage" class="block text-sm font-medium text-gray-700 mb-1">Language</label>
                <select id="promptLanguage" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                    <option value="english">English</option>
                    <option value="spanish">Spanish</option>
                    <option value="french">French</option>
                    <option value="german">German</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <button type="submit" class="w-full bg-emerald-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-emerald-700 transition">Save Prompt</button>
        </form>
    </div>

    <script>
        const promptCategory = document.getElementById('promptCategory');
        const promptOutputType = document.getElementById('promptOutputType');

        // Fetch categories and output types from the main page filters
        fetch('prompts.json')
            .then(response => response.json())
            .then(prompts => {
                const categories = new Set();
                const outputTypes = new Set();

                prompts.forEach(prompt => {
                    categories.add(prompt.category);
                    outputTypes.add(prompt.outputType);
                });

                // Populate categories
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.toLowerCase();
                    option.textContent = category;
                    promptCategory.appendChild(option);
                });

                // Populate output types
                outputTypes.forEach(type => {
                    const option = document.createElement('option');
                    option.value = type.toLowerCase();
                    option.textContent = type;
                    promptOutputType.appendChild(option);
                });
            });

        // Handle form submission
        document.getElementById('updatePromptForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const newPrompt = {
                title: document.getElementById('promptTitle').value,
                prompt: document.getElementById('promptText').value,
                category: document.getElementById('promptCategory').value,
                outputType: document.getElementById('promptOutputType').value,
                language: document.getElementById('promptLanguage').value
            };

            fetch('/save-prompt', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(newPrompt)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to save the new prompt.');
                }
                alert('Prompt saved successfully!');
                document.getElementById('updatePromptForm').reset();
            })
            .catch(error => {
                console.error('Error saving the new prompt:', error);
                alert('Failed to save the prompt.');
            });
        });
    </script>
</body>
</html>
